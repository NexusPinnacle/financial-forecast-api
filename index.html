<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Forecast App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Integrated Financial Forecast</h1>
        <p>Enter your baseline figures and assumptions below to generate the multi-year forecast.</p>

        <h2>Forecast Horizon</h2>
        <div class="input-group" style="justify-content: flex-start; gap: 15px; margin-bottom: 25px;">
            <label style="flex-basis: auto;">Select Duration:</label>
            <button type="button" class="year-select-btn selected-year-btn" data-years="3">3 Years</button>
            <button type="button" class="year-select-btn" data-years="5">5 Years</button>
            <button type="button" class="year-select-btn" data-years="10">10 Years</button>
        </div>
        
        <form id="forecastForm">
            <input type="hidden" id="forecast_years" value="3"> 
            <h2>Baseline & Assumptions</h2>
            
            <div class="input-layout">
                <div class="left-pane">
                    <h3>Core Assumptions</h3>
                    
                    <div class="input-group">
                        <label for="currency_symbol">Select Currency:</label>
                        <select id="currency_symbol" style="flex-basis: 35%;">
                            <option value="$">$ USD</option>
                            <option value="€">€ EUR</option>
                            <option value="£">£ GBP</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label for="initial_revenue">Year 0 Revenue ($):</label>
                        <input type="number" id="initial_revenue" name="initial_revenue" value="1000000" step="10000">
                    </div>
                    
                    <div class="input-group">
                        <label for="initial_cash">Year 0 Cash ($):</label>
                        <input type="number" id="initial_cash" name="initial_cash" value="100000" step="1000">
                    </div>

                    <div class="input-group">
                        <label for="initial_ppe">Year 0 Net PP&E ($):</label>
                        <input type="number" id="initial_ppe" name="initial_ppe" value="250000" step="1000">
                    </div>
                    
                    <div class="input-group">
                        <label for="initial_debt">Year 0 Debt ($):</label>
                        <input type="number" id="initial_debt" name="initial_debt" value="50000" step="1000">
                    </div>

                    <hr>

                    <h3>Rate Assumptions (Constant)</h3>
                    
                    <div class="input-group">
                        <label for="tax_rate">Tax Rate (%):</label>
                        <input type="number" id="tax_rate" name="tax_rate" value="25" min="0" max="100" step="1">
                    </div>

                    <div class="input-group">
                        <label for="depreciation_rate">Depreciation Rate (% of BGN PP&E):</label>
                        <input type="number" id="depreciation_rate" name="depreciation_rate" value="10" min="0" step="1">
                    </div>
                    
                    <div class="input-group">
                        <label for="interest_rate">Interest Rate (% of BGN Debt):</label>
                        <input type="number" id="interest_rate" name="interest_rate" value="5" min="0" step="0.1">
                    </div>
                </div> 

                <div class="right-pane">
                    <h3>Granular Assumptions (Year-Specific)</h3>
                    <p class="guide-text">Click to set year-specific values. Default values will be used if left blank or closed.</p>
                    
                    <div class="input-group">
                        <label for="default_revenue_growth">Default Revenue Growth (%):</label>
                        <input type="number" id="default_revenue_growth" value="5" min="-50" step="0.1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific Revenue Growth</div>
                        <div id="revenue-growth-container" class="collapsible-content"></div>
                    </div>

                    <div class="input-group">
                        <label for="default_cogs_pct">Default COGS % of Revenue:</label>
                        <input type="number" id="default_cogs_pct" value="60" min="0" max="100" step="0.1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific COGS %</div>
                        <div id="cogs-pct-container" class="collapsible-content"></div>
                    </div>

                    <div class="input-group">
                        <label for="default_fixed_opex">Default Fixed Opex ($):</label>
                        <input type="number" id="default_fixed_opex" value="100000" min="0" step="1000">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific Fixed Opex</div>
                        <div id="fixed-opex-container" class="collapsible-content"></div>
                    </div>

                    <div class="input-group">
                        <label for="default_capex_rate">Default CapEx Rate (% of P.Y. Revenue):</label>
                        <input type="number" id="default_capex_rate" value="5" min="0" step="0.1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific CapEx Rate</div>
                        <div id="capex-container" class="collapsible-content"></div>
                    </div>

                    <hr>
                    
                    <h3>Working Capital Assumptions (Year-Specific)</h3>
                    
                    <div class="input-group">
                        <label for="default_dso_days">Default DSO Days (AR):</label>
                        <input type="number" id="default_dso_days" value="30" min="0" step="1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific DSO Days</div>
                        <div id="dso-days-container" class="collapsible-content"></div>
                    </div>

                    <div class="input-group">
                        <label for="default_dio_days">Default DIO Days (Inventory):</label>
                        <input type="number" id="default_dio_days" value="45" min="0" step="1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific DIO Days</div>
                        <div id="dio-days-container" class="collapsible-content"></div>
                    </div>

                    <div class="input-group">
                        <label for="default_dpo_days">Default DPO Days (AP):</label>
                        <input type="number" id="default_dpo_days" value="60" min="0" step="1">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific DPO Days</div>
                        <div id="dpo-days-container" class="collapsible-content"></div>
                    </div>

                    <hr>

                    <h3>Financing Assumptions (Year-Specific)</h3>
                    
                    <div class="input-group">
                        <label for="default_debt_repayment">Default Annual Debt Repayment ($):</label>
                        <input type="number" id="default_debt_repayment" value="10000" min="0" step="1000">
                    </div>
                    <div class="collapsible-section">
                        <div class="collapsible-header">Set Year-Specific Debt Repayment</div>
                        <div id="debt-repayment-container" class="collapsible-content"></div>
                    </div>

                </div> 
            </div> 
            
            <button type="submit" id="calculateBtn">Calculate Forecast</button>
            <p id="error-message" class="error-message"></p>
        </form>

        <div id="results-container" style="display: none;">
            <h2>Forecasted Income Statement</h2>
            <table id="incomeStatementTable"><thead></thead><tbody></tbody></table>
            <h2>Forecasted Balance Sheet</h2>
            <table id="balanceSheetTable"><thead></thead><tbody></tbody></table>
            <h2>Forecasted Cash Flow Statement</h2>
            <table id="cashFlowTable"><thead></thead><tbody></tbody></table>
            <button id="exportBtn" style="background-color: #1e6f5c; margin-top: 20px;">Export to Excel</button>
            <h2>Forecasted KPIs - Visual Trends</h2>
            <div style="width: 100%; margin: 20px auto; display: flex; flex-wrap: wrap; justify-content: space-around;">
                <div style="width: 48%; min-width: 350px; margin-bottom: 20px;"><canvas id="revenueKpiChart"></canvas></div>
                <div style="width: 48%; min-width: 350px; margin-bottom: 20px;"><canvas id="cashDebtChart"></canvas></div>
            </div>
        </div>
    </div>
    
<div id="confirmationModal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <p id="modal-message"></p>
        <div class="modal-actions">
            <button id="modal-confirm-btn" class="modal-btn confirm">Continue</button>
            <button id="modal-cancel-btn" class="modal-btn cancel">Cancel</button>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="script.js"></script>
</body>
</html>
