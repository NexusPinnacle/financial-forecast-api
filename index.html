<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Forecast App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="main-nav">
        <div class="nav-links">
            <button class="nav-btn active" onclick="showPage('page-assumptions')">Assumptions</button>
            <button class="nav-btn" onclick="showPage('page-pl')">P&L</button>
            <button class="nav-btn" onclick="showPage('page-bs')">Balance Sheet</button>
            <button class="nav-btn" onclick="showPage('page-cf')">Cash Flow</button>
            <button class="nav-btn" onclick="showPage('page-visuals')">Visual Trends</button>
        </div>
        <button id="exportBtn" class="nav-export-btn">Export to Excel</button>
    </nav>

    <div class="container">
        <div id="page-assumptions" class="page active">
            <h1>Forecast Assumptions</h1>
            
            <div class="settings-row">
                <div class="mode-group">
                    <label>Period Mode:</label>
                    <div class="toggle-buttons">
                        <button type="button" class="mode-btn active" data-mode="annual">Annual</button>
                        <button type="button" class="mode-btn" data-mode="monthly">Monthly</button>
                    </div>
                </div>
                <div class="duration-group">
                    <label id="duration-label">Duration:</label>
                    <div id="annual-buttons" class="duration-buttons">
                        <button type="button" class="year-select-btn selected-year-btn" data-value="3">3Y</button>
                        <button type="button" class="year-select-btn" data-value="5">5Y</button>
                        <button type="button" class="year-select-btn" data-value="10">10Y</button>
                    </div>
                    <div id="monthly-buttons" class="duration-buttons" style="display: none;">
                        <button type="button" class="month-select-btn" data-value="12">12M</button>
                        <button type="button" class="month-select-btn" data-value="24">24M</button>
                        <button type="button" class="month-select-btn" data-value="36">36M</button>
                    </div>
                </div>
            </div>

            <form id="forecastForm">
                <input type="hidden" id="forecast_years" value="3"> 
                <input type="hidden" id="period_mode" value="annual">
                
                <div class="input-layout">
                    <div class="left-pane">
                        <h3>Baseline Figures</h3>
                        <div class="input-group">
                            <label>Currency:</label>
                            <select id="currency_symbol"><option value="$">$ USD</option><option value="€">€ EUR</option></select>
                        </div>
                        <div class="input-group"><label>Initial Rev:</label><input type="number" id="initial_revenue" value="1000"></div>
                        <div class="input-group"><label>Growth %:</label><input type="number" id="default_revenue_growth" value="5"></div>
                        <div class="input-group"><label>COGS %:</label><input type="number" id="default_cogs_pct" value="40"></div>
                        <div class="input-group"><label>Initial PP&E:</label><input type="number" id="initial_ppe" value="500"></div>
                        <div class="input-group"><label>Fixed Opex:</label><input type="number" id="default_fixed_opex" value="100"></div>
                        <div class="input-group"><label>Depr. Rate %:</label><input type="number" id="depreciation_rate" value="10"></div>
                        <div class="input-group"><label>Tax Rate %:</label><input type="number" id="tax_rate" value="25"></div>
                        <div class="input-group"><label>Initial Cash:</label><input type="number" id="initial_cash" value="100"></div>
                        <div class="input-group"><label>Initial Debt:</label><input type="number" id="initial_debt" value="200"></div>
                        <div class="input-group"><label>Int. Rate %:</label><input type="number" id="interest_rate" value="5"></div>
                    </div>
                    
                    <div class="right-pane">
                        <h3>Granular Assumptions</h3>
                        <div class="granular-section">
                            <h4 class="collapsible-header" data-target="revenue-growth-container">Rev Growth (%) <span class="toggle-icon">▼</span></h4>
                            <div id="revenue-growth-container" class="collapsible-content expanded-content"></div>
                        </div>
                        <div class="granular-section">
                            <h4 class="collapsible-header collapsed" data-target="debt-repayment-container">Debt Repay (Amt) <span class="toggle-icon">▼</span></h4>
                            <div id="debt-repayment-container" class="collapsible-content"></div>
                        </div>
                        </div>
                </div>
                <button type="submit" id="calculateBtn">Run Calculations</button>
                <p id="error-message" class="error-message"></p>
            </form>
        </div>

        <div id="page-pl" class="page">
            <h1>Income Statement (P&L)</h1>
            <div class="table-responsive"><table id="incomeStatementTable"><thead></thead><tbody></tbody></table></div>
        </div>

        <div id="page-bs" class="page">
            <h1>Balance Sheet</h1>
            <div class="table-responsive"><table id="balanceSheetTable"><thead></thead><tbody></tbody></table></div>
        </div>

        <div id="page-cf" class="page">
            <h1>Cash Flow Statement</h1>
            <div class="table-responsive"><table id="cashFlowTable"><thead></thead><tbody></tbody></table></div>
        </div>

        <div id="page-visuals" class="page">
            <h1>Visual Trends</h1>
            <div class="charts-grid">
                <div class="chart-container"><canvas id="revenueKpiChart"></canvas></div>
                <div class="chart-container"><canvas id="cashDebtChart"></canvas></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
